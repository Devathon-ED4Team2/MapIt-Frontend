
<div class="my-6 ml-6 overflow-hidden h-full inline-block" >
<mat-card class="w-full" style="height: 90%;">
    <mat-icon class="material-symbols-outlined absolute top-0 right-0" aria-hidden="false" aria-label="Example home icon" fontIcon="close" (click)="closedWindow()"></mat-icon>
    <mat-card-header style="justify-content: center; align-items: center; margin-bottom: 0.5rem;">
        <mat-card-title >{{place.name}}</mat-card-title>
    </mat-card-header>

    <img mat-card-image class="self-center" [src]="place.photos[0]" alt="" style="height: 300px; width: 400px">
    <div class="star-rating-container">
        <app-star-rating [rating]="rating" [editable]="false"></app-star-rating>

    </div>

    <mat-card-content class="overflow-hidden p-0">
        <mat-tab-group class="h-full" mat-stretch-tabs="false" mat-align-tabs="start">
            <mat-tab label="Información" class="overflow-y-auto">
                <mat-card>
                    <mat-card-content>
                        <div>
                            <p>{{place.formatAddress}}</p>
                            <p>Teléfono: {{place.formattedPhoneNumber}}</p>
                            <p>Accesibilidad con silla de ruedas: {{ getWheelchairAccesibleEntrance() }}</p>

                            <div *ngIf="haveWeekday">
                                <h3>Horario de apertura: </h3>
                                <ul>
                                    <li *ngFor="let weekday of place.weekday">{{ weekday | titlecase }}</li>
                                </ul>
                            </div>
                            <div *ngIf="!haveWeekday" class="text-neutral-400">
                                <p>Horario de apertura no disponible</p>
                            </div>

                           
                        </div>
                    </mat-card-content>
                </mat-card>
            </mat-tab>

            <mat-tab label="Comentarios">
                <mat-card>
                    <form class="py-4 px-10"
                        style=" display: flex; flex-direction: column; justify-content: center; ">
                        <mat-form-field class="full-width">
                            <mat-label>Mi opinión</mat-label>
                            <textarea appearance="outline" type="text" matInput [(ngModel)]="comentInput"
                                [ngModelOptions]="{standalone: true}" placeholder="Escribe aquí tu comentario"
                                rows="3"></textarea>
                        </mat-form-field>
                        <app-star-rating [(rating)]="userRating" [editable]="true"></app-star-rating>
                        <button *ngIf="!comentedByUser" userComment mat-raised-button color="primary" (click)="sendComment()">Enviar opinión</button>
                        <button *ngIf="comentedByUser" userComment mat-raised-button color="primary" (click)="updateComment()">Actualizar opinión</button>
                    </form>
                    <section *ngIf="comments === []"  class="text-center"> 
                        <p >No hay comentarios sobre este lugar</p>
                        <p>de otros usuarios</p>
                    </section>
                    
                    <ul *ngIf="comments">
                        <li *ngFor="let comment of comments">
                            <mat-card class= "border-solid border-blue-400 bg-blue-300">
                                <mat-card-header class= "m-2 ">
                                    <p class= "font-semibold">{{getWrittenBy(comment.writtenBy)}}</p>
                                    <p class="absolute right-0 font-thin text-left">fecha</p>
                                </mat-card-header>
                            </mat-card>
                        </li>
                    </ul>
                        <!-- templade para cuando no hay comentarios -->
                        <ng-template #noCommentsFound>
                            <p class="text-center">No hay comentarios sobre este lugar <br> de otros usuarios</p>
                        </ng-template>
                    

                    <mat-card-footer class="flex justify-center items-center">
                        <button *ngIf="previousPage === undefined" mat-flat-button disabled>
                            <mat-icon>navigate_before</mat-icon>
                        </button>
                        <button *ngIf="previousPage !== undefined" mat-flat-button (click)="getComments(previousPage)" >
                            <mat-icon>navigate_before</mat-icon>
                        </button>
                        <button *ngIf="comments === []" mat-flat-button disabled>
                            <mat-icon>navigate_next</mat-icon>
                        </button>
                        <button *ngIf="nextPage !== undefined" mat-flat-button (click)="getComments(nextPage)" >
                            <mat-icon>navigate_next</mat-icon>
                        </button>
                    </mat-card-footer>

                </mat-card>
            </mat-tab>
        </mat-tab-group>
    </mat-card-content>
</mat-card>
</div>